<routes xmlns="http://camel.apache.org/schema/spring">
    <!-- securezone-notification to packet-uploader Route -->
    <route id="securezone-notification-->packet-uploader activated route">
        <from uri="workflow-cmd://securezone-notification-activated-bus-out" />
        <log
                message="securezone-notification-->packet-uploader activated route ${bodyAs(String)}" />
        <choice>
            <when>
				<jsonpath>$.[?(@['isValid'] == false &amp;&amp; @['internalError'] == true)]</jsonpath>
                <to uri="workflow-cmd://complete-as-failed" />
            </when>
			<when>
				<jsonpath>$.[?(@['isValid'] == true &amp;&amp; @['internalError'] == true)]</jsonpath>
                <to uri="workflow-cmd://mark-as-reprocess" />
            </when>
            <when>
				<jsonpath>$.[?(@['isValid'] == false &amp;&amp; @['internalError'] == false)]</jsonpath>
                <to uri="workflow-cmd://complete-as-failed" />
            </when>
            <otherwise>
                <to uri="workflow-cmd://packet-uploader-bus-in" />
            </otherwise>
        </choice>
    </route>
    <!-- Packet uploader to uin-generator Route -->
    <route id="packet-uploader-->uin-generator activated route">
        <from uri="workflow-cmd://packet-uploader-activated-bus-out" />
        <log
            message="packet-uploader-->uin-generator activated route ${bodyAs(String)}" />
        <choice>
			<when>
				<jsonpath>$.[?(@['isValid'] == false &amp;&amp; @['internalError'] == true)]</jsonpath>
                <to uri="workflow-cmd://complete-as-failed" />
            </when>
			<when>
				<jsonpath>$.[?(@['isValid'] == true &amp;&amp; @['internalError'] == true)]</jsonpath>
                <to uri="workflow-cmd://mark-as-reprocess" />
            </when>
            <when>
				<jsonpath>$.[?(@['isValid'] == false &amp;&amp; @['internalError'] == false)]</jsonpath>
                <to uri="workflow-cmd://complete-as-failed" />
            </when>
            <otherwise>
                <to uri="workflow-cmd://uin-generator-bus-in" />
            </otherwise>
        </choice>
    </route>
    <!-- UIN Generator to Printing and Message Sender Route -->
    <route id="uin-generation route-->printing-stage-->message-sender activated route">
        <from uri="workflow-cmd://uin-generator-activated-bus-out" />
        <log
            message="uin-generation-->printing-stage and message-sender-stage activated route ${bodyAs(String)}" />
        <choice>
            <when>
				<jsonpath>$.[?(@['isValid'] == false &amp;&amp; @['internalError'] == true)]</jsonpath>
                <to uri="workflow-cmd://complete-as-failed" />
            </when>
			<when>
				<jsonpath>$.[?(@['isValid'] == true &amp;&amp; @['internalError'] == true)]</jsonpath>
                <to uri="workflow-cmd://mark-as-reprocess" />
            </when>
			<when>
				<jsonpath>$.[?(@['isValid'] == false &amp;&amp; @['internalError'] == false)]</jsonpath>
                <to uri="workflow-cmd://complete-as-failed" />
            </when>
			<otherwise>
                <to uri="workflow-cmd://printing-bus-in" />
				<to uri="workflow-cmd://complete-as-processed" />
            </otherwise>
        </choice>
    </route>
</routes>
